IDENTIFICATION DIVISION.
PROGRAM-ID. ouvrir_compte.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT COMPTES-FILE ASSIGN TO 'comptes.dat'
        ORGANIZATION IS INDEXED
        ACCESS MODE IS DYNAMIC
        RECORD KEY IS NUMERO-COMPTE
        FILE STATUS IS WS-FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD COMPTES-FILE.
01 COMPTE-RECORD.
   05 NUMERO-COMPTE        PIC X(10).
   05 NOM-TITULAIRE        PIC X(30).
   05 SOLDE-COMPTE         PIC 9(9)V99.
   05 TYPE-COMPTE          PIC X(10).
   05 DATE-CREATION        PIC X(10).

WORKING-STORAGE SECTION.
01 WS-FILE-STATUS          PIC X(02).

PROCEDURE DIVISION.
OUVERTURE-COMPTE.
    OPEN I-O COMPTES-FILE.
    DISPLAY "Entrez le numéro de compte : ".
    ACCEPT NUMERO-COMPTE.
    DISPLAY "Entrez le nom du titulaire : ".
    ACCEPT NOM-TITULAIRE.
    MOVE ZEROES TO SOLDE-COMPTE.
    DISPLAY "Entrez le type de compte (Courant/Epargne) : ".
    ACCEPT TYPE-COMPTE.
    MOVE FUNCTION CURRENT-DATE TO DATE-CREATION.

    WRITE COMPTE-RECORD.
    IF WS-FILE-STATUS = '00'
        DISPLAY "Compte créé avec succès."
    ELSE
        DISPLAY "Erreur lors de la création du compte."
    END-IF.

    CLOSE COMPTES-FILE.
    STOP RUN.